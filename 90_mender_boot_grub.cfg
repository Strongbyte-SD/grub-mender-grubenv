maybe_drop_to_grub_prompt

if [ ${mender_boot_part} = "2" ]; then
    luks_name="${mender_luks_rootfsa_uuid}"
else
    luks_name="${mender_luks_rootfsb_uuid}"
fi

mender_kernel_path="(crypto0)/boot"

if [ "${drop_to_grub_prompt}" = "no" ]; then
    cryptomount ${mender_grub_storage_device},gpt${mender_boot_part}
    if linux ${mender_kernel_path}/${kernel_imagetype} luks.name=${luks_name}=rootfs root=/dev/mapper/rootfs ${bootargs}; then
        if test -n "${initrd_imagetype}" -a test -e "${mender_kernel_path}/${initrd_imagetype}"; then
            initrd "${mender_kernel_path}/${initrd_imagetype}"
        fi
        maybe_pause "Pausing before booting."
        boot
    fi
    maybe_pause "Pausing after failed boot."
fi
